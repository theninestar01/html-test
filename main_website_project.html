<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QR Editor — เพิ่ม/แก้ไขรูป QR Code 3 รูป</title>
  <style>
    :root{--bg:#f6f8fb;--card:#fff;--accent:#2563eb;--muted:#6b7280}
    body{font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:var(--bg); margin:0;padding:24px;color:#111}
    h1{font-size:1.25rem;margin:0 0 18px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(16,24,40,0.06);min-height:300px;display:flex;flex-direction:column;gap:10px}
    .preview{height:200px;border-radius:8px;border:1px dashed #ddd;display:flex;align-items:center;justify-content:center;overflow:hidden;background:#fafafa}
    .preview img{max-width:100%;max-height:100%;display:block}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    input[type=text]{flex:1;padding:8px;border-radius:8px;border:1px solid #e5e7eb}
    button{padding:8px 10px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer}
    .btn-ghost{background:transparent;color:var(--accent);border:1px solid #e5e7eb}
    label.file-btn{padding:8px 10px;border-radius:8px;border:1px dashed #cbd5e1;background:transparent;cursor:pointer}
    .muted{color:var(--muted);font-size:0.9rem}
    .row{display:flex;gap:8px;align-items:center}
    .small{font-size:0.85rem}
    .actions{margin-top:auto;display:flex;justify-content:space-between;align-items:center}
    .drop-active{border-color:var(--accent);background:#f0f9ff}
    footer{margin-top:18px;color:var(--muted);font-size:0.9rem}
    .project-header {margin-bottom:24px;background:#fff;border-radius:12px;padding:16px;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
    .project-header input[type=text]{width:100%;font-size:1.2rem;margin-bottom:10px;border:1px solid #ddd;border-radius:8px;padding:8px}
    .project-image{width:100%;height:300px;border:2px dashed #ccc;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden;background:#fafafa}
    .project-image img{max-width:100%;max-height:100%;object-fit:contain}
  </style>
</head>
<body>
 <style>
  :root{
    --bg:#f6f8fb;
    --card:#ffffffdd;
    --accent:#2563eb;
    --muted:#e2e8f0;
  }

  body{
    font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    /* ใส่รูปพื้นหลังไว้จริง ๆ ที่ body (จะอยู่หลังสุดโดยอัตโนมัติ) */
    background: url("screen tech.jpg") no-repeat center center fixed;
    background-size: cover;
    margin:0;
    padding:24px;
    color:#fff;
  }

  /* เพิ่ม overlay โปร่งใสเบา ๆ เพื่อให้อ่านตัวอักษรชัด */
  body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: 0;              /* อยู่หลังสุด */
  }

  /* เนื้อหาทั้งหมดให้อยู่เหนือ overlay */
  body > * {
    position: relative;
    z-index: 1;
  }

  h1{font-size:1.25rem;margin:0 0 18px;color:#fff;}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
  .card{
    background:var(--card);
    border-radius:12px;
    padding:14px;
    box-shadow:0 6px 18px rgba(16,24,40,0.3);
    min-height:300px;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .preview{height:200px;border-radius:8px;border:1px dashed #ddd;display:flex;align-items:center;justify-content:center;overflow:hidden;background:#fafafa}
  .preview img{max-width:100%;max-height:100%;display:block}
  .controls{display:flex;gap:8px;flex-wrap:wrap}
  input[type=text]{flex:1;padding:8px;border-radius:8px;border:1px solid #e5e7eb}
  button{padding:8px 10px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer}
  .btn-ghost{background:transparent;color:var(--accent);border:1px solid #e5e7eb}
  label.file-btn{padding:8px 10px;border-radius:8px;border:1px dashed #cbd5e1;background:transparent;cursor:pointer}
  .muted{color:var(--muted);font-size:0.9rem}
  .row{display:flex;gap:8px;align-items:center}
  .small{font-size:0.85rem}
  .actions{margin-top:auto;display:flex;justify-content:space-between;align-items:center}
  .drop-active{border-color:var(--accent);background:#f0f9ff}
  footer{margin-top:18px;color:#e2e8f0;font-size:0.9rem}
  .project-header {margin-bottom:24px;background:#ffffffcc;border-radius:12px;padding:16px;box-shadow:0 4px 10px rgba(0,0,0,0.3)}
  .project-header input[type=text]{width:100%;font-size:1.2rem;margin-bottom:10px;border:1px solid #ddd;border-radius:8px;padding:8px}
  .project-image{width:100%;height:300px;border:2px dashed #ccc;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden;background:#fafafa}
  .project-image img{max-width:100%;max-height:100%;object-fit:contain}
</style>


  <div class="project-header">
    <input type="text" id="projectTitle" placeholder="กรอกชื่อโปรเจ็กต์ที่นี่ เช่น Forklift with Arduino Uno" />
    <div class="project-image" id="projectImage">
      <span class="muted">ยังไม่มีรูปโปรเจ็กต์ — อัปโหลดได้ด้านล่าง</span>
    </div>
    <label class="file-btn" style="margin-top:8px;display:inline-block;">
      อัปโหลดรูปโปรเจ็กต์หลัก
      <input type="file" accept="image/*" id="projectImageInput" />
    </label>
  </div>

  <h1>สมาชิกกลุ่ม</h1>
  <p class="muted">
ชยพัศ บำรุงพรไพศาล 6610110448<br>
อามีร มะยิ 6610110711<br>
วรากร ปิยวิสุทธิรักษ์ 6610110634<br>
พีรพัฒน์ ภักดีอักษร 6610110216<br>
วุฒิพงศ์ สนอยู่ 6610110642<br>
รวิกร สุวรรณบัณฑิต 6610110258<br>
นายจารุเดช เพชรวิโรจน์ 6610110039<br>
นายศิวกร นุ่นทอง 6610110649</p>

  <div class="grid" id="cards"></div>

  <footer>
<h2>อัปโหลดรูปอุปกรณ์</h2>
<div class="grid" id="equipments"></div>

<script>
  const equipmentList = [
    "Aduno Uno R3 1 ตัว",
    "Motor DC 12v 4 ตัว",
    "ชั้นวางของ Plastic 3D printer",
    "Relay 4 ตัว",
    "เฟือง 3D printer 3 ชิ้น",
    "หัวคีบ 3D printer",
    "L293D ควบคุมมอเตอร์ไดรฟ์",
    "รางถ่านและถ่าน 1.5v"
  ];

  const eqContainer = document.getElementById('equipments');

  equipmentList.forEach((eq, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <div><strong>${eq}</strong></div>
      <div class="preview" id="eq-preview-${i}">
        <div class="muted">ยังไม่มีรูปอุปกรณ์นี้</div>
      </div>
      <label class="file-btn">อัปโหลดรูปอุปกรณ์
        <input type="file" accept="image/*" style="display:none" id="eq-file-${i}">
      </label>
    `;
    eqContainer.appendChild(card);

    const fileInput = card.querySelector(`#eq-file-${i}`);
    const preview = card.querySelector(`#eq-preview-${i}`);

    fileInput.addEventListener('change', ev => {
      const file = ev.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        preview.innerHTML = `<img src="${e.target.result}" alt="${eq}">`;
      };
      reader.readAsDataURL(file);
    });
  });
</script>

    <div>วัตถุประสงค์ : <br>
ใช้พื้นที่ให้เกิดประโยชน์สูงสุด <br>
เพิ่มประสิทธิภาพการขนย้ายในพื้นที่จำกัด <br>
ลดความเสี่ยงในการชนหรือเกิดอุบัติเหตุในพื้นที่แคบ<br>
<br><br>
อุปกรณ์ที่ใช้<br>
▪Aduno Uno R3 1 ตัว <br>
▪Motor DC 12v 4 ตัว <br>
▪ชั้นวางของPlastic 3D printer <br>
▪Relay 4 ตัว <br>
▪เฟือง 3d printer 3 ชิ้น <br>
▪หัวคีบ3D printer <br>
▪L293Dควบคุมมอเตอร์ไดรฟ์ <br>
▪รางถ่านและถ่าน1.5v <br>
</div>
  </footer>

  <script>
    // handle project image upload
    const projectInput = document.getElementById('projectImageInput');
    const projectImageDiv = document.getElementById('projectImage');

    projectInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = ev => {
        projectImageDiv.innerHTML = `<img src="${ev.target.result}" alt="project image">`;
      };
      reader.readAsDataURL(file);
    });

    // QR Section (same as before)
    const NUM = 3;
    const STORAGE_KEY = 'qr_editor_cards_v1';
    const container = document.getElementById('cards');

    for (let i=0;i<NUM;i++){
      const card = document.createElement('div'); card.className='card';
      card.innerHTML = `
        <div class="small">QR #${i+1}</div>
        <div class="preview" id="preview-${i}">
          <div class="muted">ยังไม่มีรูป — ลากวางหรือกด "อัปโหลด"</div>
        </div>
        <div class="row controls">
          <label class="file-btn">อัปโหลด<input type="file" accept="image/*" style="display:none" id="file-${i}"/></label>
          <input type="text" placeholder="พิมพ์ข้อความเพื่อสร้าง QR (เช่น URL)" id="text-${i}" />
          <button id="gen-${i}">สร้าง</button>
        </div>
        <div class="row small muted"><div id="info-${i}"></div></div>
        <div class="actions">
          <div style="display:flex;gap:8px">
            <button class="btn-ghost" id="clear-${i}">ลบ</button>
            <button class="btn-ghost" id="reset-all">ล้างทั้งหมด</button>
          </div>
          <div style="display:flex;gap:8px">
            <button id="download-${i}" class="btn-ghost">ดาวน์โหลด</button>
            <button id="edit-${i}" class="btn-ghost">เปลี่ยน</button>
          </div>
        </div>
      `;
      container.appendChild(card);
      setupCard(i);
    }

    function loadState(){try{const raw=localStorage.getItem(STORAGE_KEY);if(!raw)return[];return JSON.parse(raw);}catch(e){return[]}}
    function saveState(state){localStorage.setItem(STORAGE_KEY,JSON.stringify(state));}

    function setupCard(i){
      const fileInput=document.getElementById(`file-${i}`);
      const textInput=document.getElementById(`text-${i}`);
      const genBtn=document.getElementById(`gen-${i}`);
      const preview=document.getElementById(`preview-${i}`);
      const info=document.getElementById(`info-${i}`);
      const clearBtn=document.getElementById(`clear-${i}`);
      const downloadBtn=document.getElementById(`download-${i}`);
      const editBtn=document.getElementById(`edit-${i}`);

      preview.addEventListener('dragover',ev=>{ev.preventDefault();preview.classList.add('drop-active')});
      preview.addEventListener('dragleave',ev=>{preview.classList.remove('drop-active')});
      preview.addEventListener('drop',ev=>{ev.preventDefault();preview.classList.remove('drop-active');const f=ev.dataTransfer.files[0];if(f)handleFile(i,f)});
      fileInput.addEventListener('change',ev=>{const f=ev.target.files[0];if(f)handleFile(i,f)});

      genBtn.addEventListener('click',()=>{
        const txt=textInput.value.trim();
        if(!txt){alert('กรุณาพิมพ์ข้อความที่จะสร้าง QR');return;}
        const url=`https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(txt)}`;
        setPreviewImage(i,url,{type:'generated',text:txt});
      });
      clearBtn.addEventListener('click',()=>{if(confirm('ต้องการลบรูปนี้ใช่หรือไม่?')){setPreviewEmpty(i);}});
      downloadBtn.addEventListener('click',()=>{downloadPreview(i);});
      editBtn.addEventListener('click',()=>{fileInput.click();});
      const state=loadState();
      if(state[i]){
        if(state[i].type==='image'){
          setPreviewImage(i,state[i].data,{type:'image'},false);
        }else if(state[i].type==='generated'){
          const url=`https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(state[i].text)}`;
          setPreviewImage(i,url,{type:'generated',text:state[i].text},false);
          textInput.value=state[i].text||'';
        }
      }
      function handleFile(i,file){const reader=new FileReader();reader.onload=function(e){setPreviewImage(i,e.target.result,{type:'image',name:file.name});};reader.readAsDataURL(file);}
      function setPreviewEmpty(i){preview.innerHTML='<div class="muted">ยังไม่มีรูป — ลากวางหรือกด "อัปโหลด"</div>';updateInfo(i,'');const state=loadState();state[i]=null;saveState(state);}
    }

    function setPreviewImage(i,src,meta={},save=true){const preview=document.getElementById(`preview-${i}`);preview.innerHTML='';const img=document.createElement('img');img.src=src;img.alt=`QR ${i+1}`;preview.appendChild(img);const info=document.getElementById(`info-${i}`);if(meta.type==='generated')info.textContent=`สร้างจากข้อความ: "${meta.text}"`;else if(meta.type==='image')info.textContent=meta.name?meta.name:'รูปภาพอัปโหลด';else info.textContent='';if(save){const state=loadState();state[i]=meta.type==='image'?{type:'image',data:src,name:meta.name||''}:{type:'generated',text:meta.text||'',url:src};saveState(state);}}
    function updateInfo(i,txt){document.getElementById(`info-${i}`).textContent=txt;}

    function downloadPreview(i){const preview=document.getElementById(`preview-${i}`);const img=preview.querySelector('img');if(!img){alert('ไม่มีรูปให้ดาวน์โหลด');return;}const canvas=document.createElement('canvas');const w=img.naturalWidth||400;const h=img.naturalHeight||400;canvas.width=w;canvas.height=h;const ctx=canvas.getContext('2d');if(!img.complete){img.onload=()=>{ctx.drawImage(img,0,0,w,h);triggerDownload();};}else{ctx.drawImage(img,0,0,w,h);triggerDownload();}function triggerDownload(){try{const dataUrl=canvas.toDataURL('image/png');const a=document.createElement('a');a.href=dataUrl;a.download=`qr-${i+1}.png`;document.body.appendChild(a);a.click();a.remove();}catch(e){window.open(img.src,'_blank');}}}

    document.addEventListener('click',e=>{if(e.target&&e.target.id==='reset-all'){if(confirm('ล้างข้อมูลทั้งหมดในเบราว์เซอร์?')){localStorage.removeItem(STORAGE_KEY);location.reload();}}});
  </script>
</body>

</html>